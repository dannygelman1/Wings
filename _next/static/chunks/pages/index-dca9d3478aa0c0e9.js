(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(13)}])},13:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return A}});var n,r,s=a(5893),i=a(7294),l=a(5029),o=a(1884),c=a(9477),h=a(2051);(n=r||(r={}))[n.FLYING=0]="FLYING",n[n.PERCHED=1]="PERCHED";var m=a(8626),d=a(8243);class u{incremXYZ(e,t,a){this.x+=e,this.y+=t,this.z+=a}incremVXYZ(e,t,a){this.vx+=e,this.vy+=t,this.vz+=a}incremVX(e){this.vx+=e}incremVY(e){this.vy+=e}incremVZ(e){this.vz+=e}setVX(e){this.vx=e}setVY(e){this.vy=e}setVZ(e){this.vz=e}setXYZ(e,t,a){this.x=e,this.y=t,this.z=a}setVXYZ(e,t,a){this.vx=e,this.vy=t,this.vz=a}willPerch(){return 8===c.MathUtils.randInt(0,50)}move(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz}setBias(e){this.bias=e}setAction(e){this.action=e}setPerchedAt(e){this.perchedAt=e}getSpeed(){return(this.vx**2+this.vy**2+this.vz**2)**.5}constructor({x:e,y:t,z:a,vx:n,vy:r,vz:s,bias:i,id:l,action:o,perchDur:c,perchedAt:h,perchLoc:m,flapOffset:d}){this.x=e,this.y=t,this.z=a,this.vx=n,this.vy=r,this.vz=s,this.bias=i,this.id=l,this.action=o,this.perchDur=c,this.perchedAt=h,this.perchLoc=m,this.flapOffset=d}}let x=e=>{let{border:t,height:a,boidConstants:n,boxOpacity:l,numberBirds:x,allPerching:j}=e,{camera:M,gl:S,scene:w}=(0,o.z)(),F=(0,i.useRef)(null),E=(0,i.useRef)(null);w.add(M),F.current&&M.add(F.current),E.current&&M.add(E.current);let P=(0,i.useRef)(null),[A]=(0,i.useState)(Array.from(Array(7)).map(()=>({ax:c.MathUtils.randFloat(-100,100),ay:c.MathUtils.randFloat(-100,-50),xRadius:c.MathUtils.randFloat(50,300),yRadius:c.MathUtils.randFloat(10,80),numParallel:c.MathUtils.randInt(2,3),rotation:1===c.MathUtils.randInt(0,1)?Math.PI/2:0,spacing:c.MathUtils.randInt(8,35),zTranslate:c.MathUtils.randFloat(-200,200)}))),[I]=(0,i.useState)(V(A)),[C]=(0,i.useState)(b(A,I)),[N]=(0,i.useState)(z(A,I)),{nodes:U}=(0,m.L)("/Wings/bird.gltf"),{nodes:R}=(0,m.L)("/Wings/perch.gltf"),[Z]=(0,i.useState)(U.bird instanceof c.Mesh?U.bird:null),[X]=(0,i.useState)(U.bird001 instanceof c.Mesh?U.bird001:null),[L]=(0,i.useState)(U.bird002 instanceof c.Mesh?U.bird002:null),[Y]=(0,i.useState)(R.birdperch instanceof c.Mesh?R.birdperch:null),[O,T]=(0,i.useState)(Array.from(Array(x)).map((e,t)=>{let a=c.MathUtils.randInt(0,I.length-1);return new u({x:I[a].x,y:I[a].y,z:I[a].z,vx:c.MathUtils.randFloat(-2,2),vy:c.MathUtils.randFloat(-2,2),vz:c.MathUtils.randFloat(-2,2),bias:p(t,x)||g(t,x)?c.MathUtils.randFloat(4e-5,.01):0,id:t,action:r.PERCHED,perchDur:c.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:[I[a].x,I[a].y,I[a].z,I[a].w],flapOffset:c.MathUtils.randFloat(0,10)})})),[k,D]=(0,i.useState)(x),[B,G]=(0,i.useState)([0,0,0]);(0,i.useEffect)(()=>{let e=e=>{let t=((e.clientX-230)/S.domElement.clientWidth-.5)*S.domElement.clientWidth,a=-((e.clientY-30)/S.domElement.clientHeight-.5)*S.domElement.clientHeight;G([t,a,0])};S.domElement.addEventListener("mousemove",e)},[]);let[_,J]=(0,i.useState)(0);return(0,i.useEffect)(()=>{let e=x-O.length;e>0?Array.from(Array(e)).forEach(()=>{let e=c.MathUtils.randInt(0,I.length-1);O.push(new u({x:c.MathUtils.randFloat(-1*t[0]/2,t[0]/2),y:c.MathUtils.randFloat(-1*t[1]/2+a,t[1]/2+a),z:c.MathUtils.randFloat(-1*t[2]/2,t[2]/2),vx:c.MathUtils.randFloat(-2,2),vy:c.MathUtils.randFloat(-2,2),vz:c.MathUtils.randFloat(-2,2),bias:0,id:O.length,action:r.FLYING,perchDur:c.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:[I[e].x,I[e].y,I[e].z,I[e].w],flapOffset:c.MathUtils.randFloat(0,10)}))}):Array.from(Array(-1*e)).forEach(()=>O.pop()),T(O)},[x]),(0,o.A)(e=>{let r=new Map,s=2*Math.max(n.protectedRange,n.visualRange),i=O.map((i,l)=>{var o;let m=JSON.stringify([(0,h.Z)(i.x/s)*s,(0,h.Z)(i.y/s)*s,(0,h.Z)(i.z/s)*s]);new Set(Array.from(r.keys())).has(m)?null===(o=r.get(m))||void 0===o||o.push(i):r.set(m,[i]);let d=v([(0,h.Z)(i.x/s)*s,(0,h.Z)(i.y/s)*s,(0,h.Z)(i.z/s)*s],s,i),u=e.clock.getElapsedTime();J(u);let x=new c.Vector3(i.x,i.y,i.z),p=new c.Vector3(i.perchLoc[0],i.perchLoc[1],i.perchLoc[2]),g=x.distanceTo(p);if(g<150&&(u<i.perchedAt+i.perchDur||u>20&&0===i.perchedAt)||j){let V=f(g,i,u);return V}{let b=y(O,r,d,i,t,a,n,B,e.clock.getElapsedTime());return b}});T(i)}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("pointLight",{ref:F,position:[0,.2,4],intensity:.1,color:new c.Color(90,60,0)}),(0,s.jsxs)("mesh",{position:[0,a,0],children:[(0,s.jsx)("boxGeometry",{args:[t[0],t[1],t[2]],ref:P}),(0,s.jsx)("meshStandardMaterial",{color:"gray",opacity:l,transparent:!0,side:c.DoubleSide})]}),O.map((e,t)=>(0,s.jsx)(s.Fragment,{children:e.action!==r.PERCHED?(0,s.jsxs)("mesh",{name:e.id.toString(),position:[e.x,e.y,e.z],geometry:null==Z?void 0:Z.geometry,onUpdate(t){t.lookAt(new c.Vector3(e.x+e.vx,e.y+e.vy,e.z+e.vz))},children:[(0,s.jsx)("mesh",{position:[0,0,-.5],rotation:new c.Euler(0,0,Math.sin((7*_+Math.PI/2)*2+e.flapOffset)),geometry:null==X?void 0:X.geometry,children:(0,s.jsx)("meshStandardMaterial",{color:"blue"})}),(0,s.jsx)("mesh",{position:[0,0,-.5],rotation:new c.Euler(0,0,-Math.sin((7*_+Math.PI/2)*2+e.flapOffset)),geometry:null==L?void 0:L.geometry,children:(0,s.jsx)("meshStandardMaterial",{color:"blue"})}),(0,s.jsx)("meshStandardMaterial",{color:"blue"})]},t):(0,s.jsx)("mesh",{position:new c.Vector3(e.perchLoc[0],e.perchLoc[1]-.7,e.perchLoc[2]),rotation:new c.Euler(0,0!==e.perchLoc[3]?(0,h.Z)(e.perchedAt)%2==0?Math.PI/2:-Math.PI/2:(0,h.Z)(e.perchedAt)%2==0?0:Math.PI,0),geometry:null==Y?void 0:Y.geometry,children:(0,s.jsx)("meshStandardMaterial",{color:"blue"})})})),A.map((e,t)=>Array.from(Array(e.numParallel)).map((t,a)=>(0,s.jsx)(d.x,{points:new c.EllipseCurve(e.ax,e.ay,e.xRadius,e.yRadius,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50).map(t=>new c.Vector3(t.x,t.y,0===a?e.zTranslate:1===a?e.spacing%2==0?e.zTranslate+e.spacing:e.zTranslate+e.spacing/2:e.zTranslate+2*e.spacing)),color:"blue",lineWidth:1,rotation:new c.Euler(0,e.rotation,0)},e.ax+e.ay+a))),A.map((e,t)=>{let a=C.get(t);return a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("mesh",{position:[a[0].x,a[0].y-8,a[0].z],rotation:new c.Euler(0,e.rotation+Math.PI/2,0),children:[(0,s.jsx)("boxGeometry",{args:[1===e.numParallel?10:2===e.numParallel?1.5*e.spacing:3*e.spacing,3,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),(0,s.jsxs)("mesh",{position:[a[1].x,a[1].y-8,a[1].z],rotation:new c.Euler(0,e.rotation+Math.PI/2,0),children:[(0,s.jsx)("boxGeometry",{args:[1===e.numParallel?10:2===e.numParallel?1.5*e.spacing:3*e.spacing,3,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),(0,s.jsxs)("mesh",{position:[a[0].x,a[0].y-150,a[0].z],children:[(0,s.jsx)("boxGeometry",{args:[3,300,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),(0,s.jsxs)("mesh",{position:[a[1].x,a[1].y-150,a[1].z],children:[(0,s.jsx)("boxGeometry",{args:[3,300,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),Array.from(Array(e.numParallel)).map((e,a)=>{let n=N.get(JSON.stringify([t,a]));return n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("mesh",{position:[n[0].x,n[0].y-4,n[0].z],children:[(0,s.jsx)("cylinderGeometry",{args:[.5,1,5]}),(0,s.jsx)("meshStandardMaterial",{color:new c.Color(3355443)})]}),(0,s.jsxs)("mesh",{position:[n[1].x,n[1].y-4,n[1].z],children:[(0,s.jsx)("cylinderGeometry",{args:[.5,1,5]}),(0,s.jsx)("meshStandardMaterial",{color:new c.Color(3355443)})]})]}):(0,s.jsx)(s.Fragment,{})})]}):(0,s.jsx)(s.Fragment,{})})]})},p=(e,t)=>e<t/5,g=(e,t)=>e>t/5&&e<2*t/5,y=(e,t,a,n,s,i,l,o,h)=>{let m=new c.Vector3(n.x,n.y,n.z);new c.Vector3(n.vx,n.vy,n.vz);let d=0,u=0,x=0,y=0,f=0,v=0,V=0,b=0,z=0,j=0;for(let M of a)if(new Set(Array.from(t.keys())).has(M)){for(let S of t.get(M)||[])if(S.id!==n.id){let w=new c.Vector3(S.x,S.y,S.z);m.distanceTo(w)<l.visualRange&&(d+=S.x,u+=S.y,x+=S.z,y+=S.vx,f+=S.vy,v+=S.vz,j+=1),m.distanceTo(w)<l.protectedRange&&(V+=m.x-w.x,b+=m.y-w.y,z+=m.z-w.z)}}j>0&&n.incremVXYZ((d/j-n.x)*l.centeringFactor+(y/j-n.vx)*l.matchingFactor,(u/j-n.y)*l.centeringFactor+(f/j-n.vy)*l.matchingFactor,(x/j-n.z)*l.centeringFactor+(v/j-n.vz)*l.matchingFactor),n.incremVXYZ(V*l.avoidFactor,b*l.avoidFactor,z*l.avoidFactor);let F=s[0]/2,E=-1*s[0]/2,P=s[1]/2+i,A=-1*s[1]/2+i,I=s[2]/2,C=-1*s[2]/2;n.x>F&&n.incremVX(-1*l.turnFactor),n.x<E&&n.incremVX(l.turnFactor),n.y>P&&n.incremVY(-1*l.turnFactor),n.y<A&&n.incremVY(l.turnFactor),n.z>I&&n.incremVZ(-1*l.turnFactor),n.z<C&&n.incremVZ(l.turnFactor),p(n.id,e.length)&&(n.vx>0?n.setBias(Math.min(l.maxBias,n.bias+l.biasIncrm)):n.setBias(Math.max(l.biasIncrm,n.bias-l.biasIncrm))),g(n.id,e.length)&&(n.vx<0?n.setBias(Math.min(l.maxBias,n.bias+l.biasIncrm)):n.setBias(Math.max(l.biasIncrm,n.bias-l.biasIncrm))),p(n.id,e.length)&&n.setVX((1-n.bias)*n.vx+n.bias),g(n.id,e.length)&&n.setVX((1-n.bias)*n.vx-n.bias);let N=n.getSpeed();return N<l.minSpeed&&(n.setVX(n.vx/N*l.minSpeed),n.setVY(n.vy/N*l.minSpeed),n.setVZ(n.vz/N*l.minSpeed)),N>l.maxSpeed&&(n.setVX(n.vx/N*l.maxSpeed),n.setVY(n.vy/N*l.maxSpeed),n.setVZ(n.vz/N*l.maxSpeed)),n.perchedAt+n.perchDur+10<h&&n.setPerchedAt(0),n.setAction(r.FLYING),n.move(),n},f=(e,t,a)=>{if(t.action===r.PERCHED)return t;let n=new c.Vector3(t.x,t.y,t.z),s=new c.Vector3(t.perchLoc[0],t.perchLoc[1],t.perchLoc[2]);if(e>2&&0===t.perchedAt){t.incremVX((s.x-n.x)*.01),t.incremVY((s.y-n.y)*.01),t.incremVZ((s.z-n.z)*.01);let i=t.getSpeed();i>2&&(t.setVX(t.vx/i*2),t.setVY(t.vy/i*2),t.setVZ(t.vz/i*2)),t.move()}else t.setXYZ(s.x,s.y,s.z),t.setVXYZ(0,0,0),t.setAction(r.PERCHED),t.setPerchedAt(a);return t},v=(e,t,a)=>{let n,r,s;let i=a.x,l=a.y,o=a.z,c=e[0]+t/2,h=e[1]+t/2,m=e[2]+t/2,d=[];return n=i<c?e[0]-t:e[0]+t,r=l<h?e[1]-t:e[1]+t,s=o<m?e[2]-t:e[2]+t,d.push(JSON.stringify([e[0],r,e[2]])),d.push(JSON.stringify([e[0],r,s])),d.push(JSON.stringify([e[0],e[1],e[2]])),d.push(JSON.stringify([e[0],e[1],s])),d.push(JSON.stringify([n,r,e[2]])),d.push(JSON.stringify([n,r,s])),d.push(JSON.stringify([n,e[1],e[2]])),d.push(JSON.stringify([n,e[1],s])),d},V=e=>{let t=[];for(let a of e)for(let n=0;n<a.numParallel;n++){let r=new c.EllipseCurve(a.ax,a.ay+2,a.xRadius,a.yRadius,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50).map(e=>new c.Vector3(e.x,e.y,0===n?a.zTranslate:1===n?a.spacing%2==0?a.zTranslate+a.spacing:a.zTranslate+a.spacing/2:a.zTranslate+2*a.spacing));for(let s of r){let i=new c.Vector3(s.x,s.y,s.z).applyEuler(new c.Euler(0,a.rotation,0));t.push(new c.Vector4(i.x,i.y,i.z,0===a.rotation?0:1))}}return t},b=(e,t)=>{let a=new Map,n=0,r=0;for(let s=0;s<e.length;s++){r=(n=0===s?0:r+1)+50*e[s].numParallel+(e[s].numParallel-1);let i=t[n],l=t[r];if(0===e[s].rotation){let o=(i.z+l.z)/2,h=new c.Vector3(i.x,i.y,o),m=new c.Vector3(l.x,l.y,o);a.set(s,[h,m])}else{let d=(i.x+l.x)/2,u=new c.Vector3(d,i.y,i.z),x=new c.Vector3(d,l.y,l.z);a.set(s,[u,x])}}return a},z=(e,t)=>{let a=new Map,n=0,r=0;for(let s=0;s<e.length;s++)for(let i=0;i<e[s].numParallel;i++)r=(n=0===s&&0===i?0:r+1)+50,a.set(JSON.stringify([s,i]),[new c.Vector3(t[n].x,t[n].y,t[n].z),new c.Vector3(t[r].x,t[r].y,t[r].z)]);return a};var j=a(7090),M=a(9365);let S=()=>{let[e,t]=(0,i.useState)([300,180,240]),[a,n]=(0,i.useState)(80),[r,o]=(0,i.useState)(0),[c,h]=(0,i.useState)(!1),[m,d]=(0,i.useState)(400),[u,p]=(0,i.useState)({turnfactor:.2,visualRange:40,protectedRange:4,centeringFactor:5e-4,avoidFactor:.05,matchingFactor:.05,maxSpeed:4,minSpeed:2,turnFactor:.2,maxBias:.01,biasIncrm:4e-5});return(0,s.jsxs)("div",{className:"flex flex-row items-center bg-black space-x-4 h-full w-full absolute",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-4 ml-4 mt-4",children:[(0,s.jsx)(w,{name:"number birds",min:0,max:700,defaultVal:[m],step:1,onValueChange:e=>d(e[0])}),(0,s.jsx)(w,{name:"x boundry",min:30,max:300,defaultVal:[e[0]],step:1,onValueChange:a=>t([a[0],e[1],e[2]])}),(0,s.jsx)(w,{name:"y boundry",min:30,max:300,defaultVal:[e[1]],step:1,onValueChange:a=>t([e[0],a[0],e[2]])}),(0,s.jsx)(w,{name:"z boundry",min:30,max:300,defaultVal:[e[2]],step:1,onValueChange:a=>t([e[0],e[1],a[0]])}),(0,s.jsx)(w,{name:"all perching",min:0,max:1,defaultVal:[0],step:1,onValueChange:e=>h(1===e[0])}),(0,s.jsx)(w,{name:"visual range",min:0,max:60,defaultVal:[u.visualRange],step:1,onValueChange:e=>p({...u,visualRange:e[0]})}),(0,s.jsx)(w,{name:"protected range",min:0,max:20,defaultVal:[u.protectedRange],step:1,onValueChange:e=>p({...u,protectedRange:e[0]})}),(0,s.jsx)(w,{name:"centering factor",min:0,max:.01,defaultVal:[u.centeringFactor],step:1e-4,onValueChange:e=>p({...u,centeringFactor:e[0]})}),(0,s.jsx)(w,{name:"avoid factor",min:0,max:.1,defaultVal:[u.avoidFactor],step:.001,onValueChange:e=>p({...u,avoidFactor:e[0]})}),(0,s.jsx)(w,{name:"matching factor",min:0,max:.1,defaultVal:[u.matchingFactor],step:.001,onValueChange:e=>p({...u,matchingFactor:e[0]})}),(0,s.jsx)(w,{name:"turning factor",min:.1,max:.5,defaultVal:[u.turnFactor],step:.001,onValueChange:e=>p({...u,turnFactor:e[0]})}),(0,s.jsx)(w,{name:"speed range",min:1,max:6,defaultVal:[u.minSpeed,u.maxSpeed],step:.1,onValueChange:e=>p({...u,minSpeed:e[0],maxSpeed:e[1]})}),(0,s.jsx)(w,{name:"bias range",min:0,max:.03,defaultVal:[u.biasIncrm,u.maxBias],step:1e-5,onValueChange:e=>p({...u,biasIncrm:e[0],maxBias:e[1]})}),(0,s.jsx)(w,{name:"box opacity",min:0,max:1,defaultVal:[r],step:.01,onValueChange:e=>o(e[0])})]}),(0,s.jsx)("div",{className:"w-4/5 h-[700px] bg-black",children:(0,s.jsxs)(l.Xz,{shadows:!0,camera:{fov:75,position:[400,50,-100]},className:"bg-blue-400",children:[(0,s.jsx)(F,{}),(0,s.jsx)(x,{border:e,height:a,boidConstants:u,boxOpacity:r,numberBirds:m,allPerching:c})]})})]})},w=e=>{let{min:t,max:a,defaultVal:n,step:r,name:i,onValueChange:l}=e;return(0,s.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,s.jsx)("span",{className:"text-white select-none",children:i}),(0,s.jsxs)(j.fC,{className:"relative select-none touch-none flex items-center w-[200px] h-2",minStepsBetweenThumbs:1,defaultValue:n,min:t,max:a,onValueCommit:l,step:r,"aria-label":"Volume",children:[(0,s.jsx)(j.fQ,{className:"relative bg-white rounded-full h-2 flex-grow",children:(0,s.jsx)(j.e6,{className:"absolute bg-green-500 rounded-full h-full"})}),n.map(e=>(0,s.jsx)(j.bU,{className:"block w-5 h-5 bg-green-500 rounded-full outline-none "},e))]})]})},F=()=>{let{camera:e,gl:t}=(0,o.z)();return(0,i.useEffect)(()=>{let a=new M.z(e,t.domElement);return a.enableDamping,()=>{a.dispose()}},[e,t]),null};var E=a(9008),P=a.n(E);function A(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(P(),{children:[(0,s.jsx)("title",{children:"Create Next App"}),(0,s.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,s.jsx)("link",{rel:"icon",href:"/Wings/favicon.ico"})]}),(0,s.jsx)(S,{})]})}}},function(e){e.O(0,[737,203,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);