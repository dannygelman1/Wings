(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(13)}])},13:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return F}});var n,i,s=a(5893),r=a(7294),l=a(5029),o=a(1884),h=a(9365),c=a(9477),d=a(2051);(n=i||(i={}))[n.FLYING=0]="FLYING",n[n.PERCHING=1]="PERCHING",n[n.PERCHED=2]="PERCHED";var m=a(8243);class u{incremXYZ(e,t,a){this.x+=e,this.y+=t,this.z+=a}incremVXYZ(e,t,a){this.vx+=e,this.vy+=t,this.vz+=a}incremVX(e){this.vx+=e}incremVY(e){this.vy+=e}incremVZ(e){this.vz+=e}setVX(e){this.vx=e}setVY(e){this.vy=e}setVZ(e){this.vz=e}setXYZ(e,t,a){this.x=e,this.y=t,this.z=a}setVXYZ(e,t,a){this.vx=e,this.vy=t,this.vz=a}move(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz}setBias(e){this.bias=e}setAction(e){this.action=e}setPerchedAt(e){this.perchedAt=e}setPerchLoc(e){this.perchLoc=e}getSpeed(){return(this.vx**2+this.vy**2+this.vz**2)**.5}constructor({x:e,y:t,z:a,vx:n,vy:i,vz:s,bias:r,id:l,action:o,perchDur:h,perchedAt:c,perchLoc:d}){this.x=e,this.y=t,this.z=a,this.vx=n,this.vy=i,this.vz=s,this.bias=r,this.id=l,this.action=o,this.perchDur=h,this.perchedAt=c,this.perchLoc=d}}let x=e=>{let{border:t,boidConstants:a,boxOpacity:n,numberBirds:l}=e,{camera:x,gl:M,scene:V}=(0,o.z)(),I=new h.z(x,M.domElement);I.enableDamping=!0,I.rotateSpeed=.01,I.zoomSpeed=.001,I.target.set(0,0,0),x.position.set(x.position.x,0,x.position.z),x.lookAt(I.target),I.minPolarAngle=0,I.maxPolarAngle=180,I.target.set(0,0,0);let b=(0,r.useRef)(null),P=(0,r.useRef)(null);V.add(x),b.current&&x.add(b.current),P.current&&x.add(P.current);let F=(0,r.useRef)(null);(0,r.useEffect)(()=>{V.children.forEach(e=>{var t;e instanceof c.Mesh&&e.geometry instanceof c.ConeGeometry&&(null===(t=e.geometry)||void 0===t||t.rotateX(Math.PI/2))})},[]);let[S,z]=(0,r.useState)(Array.from(Array(l)).map((e,a)=>new u({x:c.MathUtils.randFloat(-1*t[0]/2,t[0]/2),y:c.MathUtils.randFloat(-1*t[1]/2,t[1]/2),z:c.MathUtils.randFloat(-1*t[2]/2,t[2]/2),vx:c.MathUtils.randFloat(-2,2),vy:c.MathUtils.randFloat(-2,2),vz:c.MathUtils.randFloat(-2,2),bias:p(a,l)||g(a,l)?c.MathUtils.randFloat(4e-5,.01):0,id:a,action:i.FLYING,perchDur:c.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:-1}))),[j,E]=(0,r.useState)(l),[w,N]=(0,r.useState)([0,0,0]),[C,A]=(0,r.useState)(c.MathUtils.randInt(15,40)),[X,Z]=(0,r.useState)(0);(0,r.useEffect)(()=>{let e=e=>{let t=((e.clientX-230)/M.domElement.clientWidth-.5)*M.domElement.clientWidth,a=-((e.clientY-30)/M.domElement.clientHeight-.5)*M.domElement.clientHeight;N([t,a,0])};M.domElement.addEventListener("mousemove",e)},[]),(0,r.useEffect)(()=>{let e=l-S.length;e>0?Array.from(Array(e)).forEach(()=>S.push(new u({x:c.MathUtils.randFloat(-1*t[0]/2,t[0]/2),y:c.MathUtils.randFloat(-1*t[1]/2,t[1]/2),z:c.MathUtils.randFloat(-1*t[2]/2,t[2]/2),vx:c.MathUtils.randFloat(-2,2),vy:c.MathUtils.randFloat(-2,2),vz:c.MathUtils.randFloat(-2,2),bias:0,id:S.length,action:i.FLYING,perchDur:c.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:-1}))):Array.from(Array(-1*e)).forEach(()=>S.pop()),z(S),V.children.forEach((e,t)=>{if(e instanceof c.Mesh&&e.geometry instanceof c.ConeGeometry&&e instanceof c.Mesh&&e.geometry instanceof c.ConeGeometry&&parseInt(e.name)>j){var a;null===(a=e.geometry)||void 0===a||a.rotateX(Math.PI/2)}}),E(V.children.length)},[l,V.children.length]);let Y=e=>{z(S.map(t=>t.id===e.id?e:t))};return(0,o.A)(e=>{I.update();let n=new Map,i=2*Math.max(a.protectedRange,a.visualRange),s=S.map((s,r)=>{var l;let o=JSON.stringify([(0,d.Z)(s.x/i)*i,(0,d.Z)(s.y/i)*i,(0,d.Z)(s.z/i)*i]);new Set(Array.from(n.keys())).has(o)?null===(l=n.get(o))||void 0===l||l.push(s):n.set(o,[s]);let h=y([(0,d.Z)(s.x/i)*i,(0,d.Z)(s.y/i)*i,(0,d.Z)(s.z/i)*i],i,s),m=e.clock.getElapsedTime();if((0,d.Z)(m)%10==0&&X!==(0,d.Z)(m)&&(A(c.MathUtils.randInt(15,40)),Z((0,d.Z)(m))),s.id%C==0&&0!==s.id&&(m<s.perchedAt+s.perchDur||0===s.perchedAt)){let u=v(S,s,a,m);return u}{let x=f(S,n,h,s,t,a,w,e.clock.getElapsedTime());return x}});z(s)}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("pointLight",{ref:b,position:[0,.2,4],intensity:.1,color:new c.Color(90,60,0)}),(0,s.jsxs)("mesh",{position:[0,0,0],children:[(0,s.jsx)("boxGeometry",{args:[t[0],t[1],t[2]],ref:F}),(0,s.jsx)("meshStandardMaterial",{color:"gray",opacity:n,transparent:!0,side:c.DoubleSide})]}),S.map((e,t)=>(0,s.jsxs)("mesh",{name:e.id.toString(),position:[e.x,e.y,e.z],onUpdate(t){t.lookAt(new c.Vector3(e.x+e.vx,e.y+e.vy,e.z+e.vz))},children:[(0,s.jsx)("coneGeometry",{args:[1,5],onUpdate(t){let a;let n=new c.Vector3(e.x,e.y,e.z);if(0===e.perchLoc)a=new c.Vector3(50*Math.cos(-(Math.PI-2*Math.PI/8)*(e.id/S.length)-Math.PI/8),-148+10*Math.sin(-(Math.PI-2*Math.PI/8)*(e.id/S.length)-Math.PI/8),0);else{let s=new c.Euler(0,Math.PI/3,0);a=new c.Vector3(150*Math.cos(-(Math.PI-2*Math.PI/8)*(e.id/S.length)-Math.PI/8),-98+40*Math.sin(-(Math.PI-2*Math.PI/8)*(e.id/S.length)-Math.PI/8),0).applyEuler(s)}let r=n.distanceTo(a);e.action===i.PERCHED&&r>5&&(t.rotateX(Math.PI/2),e.setAction(i.FLYING),Y(e)),e.id%C==0&&e.action===i.PERCHING&&(t.rotateX(-Math.PI/2),e.setAction(i.PERCHED),Y(e))}}),(0,s.jsx)("meshStandardMaterial",{color:"blue"})]},t)),(0,s.jsx)(m.x,{points:new c.EllipseCurve(0,-150,50,10,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50),color:"blue",lineWidth:1}),(0,s.jsx)(m.x,{points:new c.EllipseCurve(0,-100,150,40,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50),color:"blue",lineWidth:1,rotation:new c.Euler(0,Math.PI/3,0)})]})},p=(e,t)=>e<t/5,g=(e,t)=>e>t/5&&e<2*t/5,f=(e,t,a,n,i,s,r,l)=>{let o=new c.Vector3(n.x,n.y,n.z),h=0,d=0,m=0,u=0,x=0,f=0,v=0,y=0,M=0,V=0;for(let I of a)if(new Set(Array.from(t.keys())).has(I)){for(let b of t.get(I)||[])if(b.id!==n.id){let P=new c.Vector3(b.x,b.y,b.z);o.distanceTo(P)<s.visualRange&&(h+=b.x,d+=b.y,m+=b.z,u+=b.vx,x+=b.vy,f+=b.vz,V+=1),o.distanceTo(P)<s.protectedRange&&(v+=o.x-P.x,y+=o.y-P.y,M+=o.z-P.z)}}V>0&&n.incremVXYZ((h/V-n.x)*s.centeringFactor+(u/V-n.vx)*s.matchingFactor,(d/V-n.y)*s.centeringFactor+(x/V-n.vy)*s.matchingFactor,(m/V-n.z)*s.centeringFactor+(f/V-n.vz)*s.matchingFactor),n.incremVXYZ(v*s.avoidFactor,y*s.avoidFactor,M*s.avoidFactor);let F=i[0]/2,S=-1*i[0]/2,z=i[1]/2,j=-1*i[1]/2,E=i[2]/2,w=-1*i[2]/2;n.x>F&&n.incremVX(-1*s.turnFactor),n.x<S&&n.incremVX(s.turnFactor),n.y>z&&n.incremVY(-1*s.turnFactor),n.y<j&&n.incremVY(s.turnFactor),n.z>E&&n.incremVZ(-1*s.turnFactor),n.z<w&&n.incremVZ(s.turnFactor),p(n.id,e.length)&&(n.vx>0?n.setBias(Math.min(s.maxBias,n.bias+s.biasIncrm)):n.setBias(Math.max(s.biasIncrm,n.bias-s.biasIncrm))),g(n.id,e.length)&&(n.vx<0?n.setBias(Math.min(s.maxBias,n.bias+s.biasIncrm)):n.setBias(Math.max(s.biasIncrm,n.bias-s.biasIncrm))),p(n.id,e.length)&&n.setVX((1-n.bias)*n.vx+n.bias),g(n.id,e.length)&&n.setVX((1-n.bias)*n.vx-n.bias);let N=n.getSpeed();return N<s.minSpeed&&(n.setVX(n.vx/N*s.minSpeed),n.setVY(n.vy/N*s.minSpeed),n.setVZ(n.vz/N*s.minSpeed)),N>s.maxSpeed&&(n.setVX(n.vx/N*s.maxSpeed),n.setVY(n.vy/N*s.maxSpeed),n.setVZ(n.vz/N*s.maxSpeed)),n.move(),n},v=(e,t,a,n)=>{let s,r;s=-1===t.perchLoc?c.MathUtils.randInt(0,1):t.perchLoc;let l=new c.Vector3(t.x,t.y,t.z);if(0===s)r=new c.Vector3(50*Math.cos(-(Math.PI-2*Math.PI/8)*(t.id/e.length)-Math.PI/8),-148+10*Math.sin(-(Math.PI-2*Math.PI/8)*(t.id/e.length)-Math.PI/8),0);else{let o=new c.Euler(0,Math.PI/3,0);r=new c.Vector3(150*Math.cos(-(Math.PI-2*Math.PI/8)*(t.id/e.length)-Math.PI/8),-98+40*Math.sin(-(Math.PI-2*Math.PI/8)*(t.id/e.length)-Math.PI/8),0).applyEuler(o)}let h=l.distanceTo(r);if(h>2&&0!==t.vx&&0!==t.vy&&0!==t.vz){t.incremVX((r.x-l.x)*h),t.incremVY((r.y-l.y)*h),t.incremVZ((r.z-l.z)*h);let d=t.getSpeed();d>a.maxSpeed&&(t.setVX(t.vx/d*a.maxSpeed),t.setVY(t.vy/d*a.maxSpeed),t.setVZ(t.vz/d*a.maxSpeed)),t.move()}else t.setXYZ(r.x,r.y,r.z),t.setVXYZ(0,0,0),t.action===i.FLYING&&(t.setAction(i.PERCHING),t.setPerchedAt(n));return t.setPerchLoc(s),t},y=(e,t,a)=>{let n,i,s;let r=a.x,l=a.y,o=a.z,h=e[0]+t/2,c=e[1]+t/2,d=e[2]+t/2,m=[];return n=r<h?e[0]-t:e[0]+t,i=l<c?e[1]-t:e[1]+t,s=o<d?e[2]-t:e[2]+t,m.push(JSON.stringify([e[0],i,e[2]])),m.push(JSON.stringify([e[0],i,s])),m.push(JSON.stringify([e[0],e[1],e[2]])),m.push(JSON.stringify([e[0],e[1],s])),m.push(JSON.stringify([n,i,e[2]])),m.push(JSON.stringify([n,i,s])),m.push(JSON.stringify([n,e[1],e[2]])),m.push(JSON.stringify([n,e[1],s])),m};var M=a(7090);let V=()=>{let[e,t]=(0,r.useState)([300,180,240]),[a,n]=(0,r.useState)(0),[i,o]=(0,r.useState)(300),[h,c]=(0,r.useState)({turnfactor:.2,visualRange:40,protectedRange:4,centeringFactor:5e-4,avoidFactor:.05,matchingFactor:.05,maxSpeed:4,minSpeed:2,turnFactor:.2,maxBias:.01,biasIncrm:4e-5});return(0,s.jsxs)("div",{className:"flex flex-row items-center bg-black space-x-4 h-full w-full absolute",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-4 ml-4 mt-4",children:[(0,s.jsx)(I,{name:"number birds",min:0,max:700,defaultVal:[i],step:1,onValueChange:e=>o(e[0])}),(0,s.jsx)(I,{name:"x boundry",min:30,max:300,defaultVal:[e[0]],step:1,onValueChange:a=>t([a[0],e[1],e[2]])}),(0,s.jsx)(I,{name:"y boundry",min:30,max:300,defaultVal:[e[1]],step:1,onValueChange:a=>t([e[0],a[0],e[2]])}),(0,s.jsx)(I,{name:"z boundry",min:30,max:300,defaultVal:[e[2]],step:1,onValueChange:a=>t([e[0],e[1],a[0]])}),(0,s.jsx)(I,{name:"visual range",min:0,max:60,defaultVal:[h.visualRange],step:1,onValueChange:e=>c({...h,visualRange:e[0]})}),(0,s.jsx)(I,{name:"protected range",min:0,max:20,defaultVal:[h.protectedRange],step:1,onValueChange:e=>c({...h,protectedRange:e[0]})}),(0,s.jsx)(I,{name:"centering factor",min:0,max:.01,defaultVal:[h.centeringFactor],step:1e-4,onValueChange:e=>c({...h,centeringFactor:e[0]})}),(0,s.jsx)(I,{name:"avoid factor",min:0,max:.1,defaultVal:[h.avoidFactor],step:.001,onValueChange:e=>c({...h,avoidFactor:e[0]})}),(0,s.jsx)(I,{name:"matching factor",min:0,max:.1,defaultVal:[h.matchingFactor],step:.001,onValueChange:e=>c({...h,matchingFactor:e[0]})}),(0,s.jsx)(I,{name:"turning factor",min:.1,max:.5,defaultVal:[h.turnFactor],step:.001,onValueChange:e=>c({...h,turnFactor:e[0]})}),(0,s.jsx)(I,{name:"speed range",min:1,max:6,defaultVal:[h.minSpeed,h.maxSpeed],step:.1,onValueChange:e=>c({...h,minSpeed:e[0],maxSpeed:e[1]})}),(0,s.jsx)(I,{name:"bias range",min:0,max:.03,defaultVal:[h.biasIncrm,h.maxBias],step:1e-5,onValueChange:e=>c({...h,biasIncrm:e[0],maxBias:e[1]})}),(0,s.jsx)(I,{name:"box opacity",min:0,max:1,defaultVal:[a],step:.01,onValueChange:e=>n(e[0])})]}),(0,s.jsx)("div",{className:"w-4/5 h-[700px] bg-black",children:(0,s.jsx)(l.Xz,{shadows:!0,camera:{fov:75,position:[0,0,Math.max(e[0],e[1],e[2])]},className:"bg-blue-400",children:(0,s.jsx)(x,{border:e,boidConstants:h,boxOpacity:a,numberBirds:i})})})]})},I=e=>{let{min:t,max:a,defaultVal:n,step:i,name:r,onValueChange:l}=e;return(0,s.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,s.jsx)("span",{className:"text-white select-none",children:r}),(0,s.jsxs)(M.fC,{className:"relative select-none touch-none flex items-center w-[200px] h-2",minStepsBetweenThumbs:1,defaultValue:n,min:t,max:a,onValueCommit:l,step:i,"aria-label":"Volume",children:[(0,s.jsx)(M.fQ,{className:"relative bg-white rounded-full h-2 flex-grow",children:(0,s.jsx)(M.e6,{className:"absolute bg-green-500 rounded-full h-full"})}),n.map(e=>(0,s.jsx)(M.bU,{className:"block w-5 h-5 bg-green-500 rounded-full outline-none "},e))]})]})};var b=a(9008),P=a.n(b);function F(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(P(),{children:[(0,s.jsx)("title",{children:"Create Next App"}),(0,s.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,s.jsx)("link",{rel:"icon",href:"/Wings/favicon.ico"})]}),(0,s.jsx)(V,{})]})}}},function(e){e.O(0,[737,962,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);