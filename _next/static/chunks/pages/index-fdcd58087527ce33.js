(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(13)}])},13:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var n,r,s=a(5893),i=a(7294),l=a(5029),o=a(1884),c=a(9365),h=a(9477),m=a(2051);(n=r||(r={}))[n.FLYING=0]="FLYING",n[n.FLYINGDOWN=1]="FLYINGDOWN",n[n.PERCHING=2]="PERCHING",n[n.PERCHED=3]="PERCHED";var d=a(8243);class x{incremXYZ(e,t,a){this.x+=e,this.y+=t,this.z+=a}incremVXYZ(e,t,a){this.vx+=e,this.vy+=t,this.vz+=a}incremVX(e){this.vx+=e}incremVY(e){this.vy+=e}incremVZ(e){this.vz+=e}setVX(e){this.vx=e}setVY(e){this.vy=e}setVZ(e){this.vz=e}setXYZ(e,t,a){this.x=e,this.y=t,this.z=a}setVXYZ(e,t,a){this.vx=e,this.vy=t,this.vz=a}willPerch(){return 8===h.MathUtils.randInt(0,50)}move(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz}setBias(e){this.bias=e}setAction(e){this.action=e}setPerchedAt(e){this.perchedAt=e}getSpeed(){return(this.vx**2+this.vy**2+this.vz**2)**.5}constructor({x:e,y:t,z:a,vx:n,vy:r,vz:s,bias:i,id:l,action:o,perchDur:c,perchedAt:h,perchLoc:m}){this.x=e,this.y=t,this.z=a,this.vx=n,this.vy=r,this.vz=s,this.bias=i,this.id=l,this.action=o,this.perchDur=c,this.perchedAt=h,this.perchLoc=m}}let u=e=>{let{border:t,height:a,boidConstants:n,boxOpacity:l,numberBirds:d}=e,{camera:u,gl:b,scene:M}=(0,o.z)(),S=new c.z(u,b.domElement);S.enableDamping=!0,S.rotateSpeed=.01,S.zoomSpeed=.001,S.target.set(0,0,0),u.lookAt(S.target),S.minPolarAngle=0,S.maxPolarAngle=180,S.target.set(0,0,0);let w=(0,i.useRef)(null),P=(0,i.useRef)(null);M.add(u),w.current&&u.add(w.current),P.current&&u.add(P.current);let N=(0,i.useRef)(null);(0,i.useEffect)(()=>{M.children.forEach(e=>{var t;e instanceof h.Mesh&&e.geometry instanceof h.ConeGeometry&&(null===(t=e.geometry)||void 0===t||t.rotateX(Math.PI/2))})},[]);let[E]=(0,i.useState)(Array.from(Array(7)).map(()=>({ax:h.MathUtils.randFloat(-100,100),ay:h.MathUtils.randFloat(-100,-50),xRadius:h.MathUtils.randFloat(50,300),yRadius:h.MathUtils.randFloat(10,80),numParallel:h.MathUtils.randInt(2,3),rotation:1===h.MathUtils.randInt(0,1)?Math.PI/2:0,spacing:h.MathUtils.randInt(8,35),zTranslate:h.MathUtils.randFloat(-200,200)}))),[I]=(0,i.useState)(V(E)),[A]=(0,i.useState)(j(E,I)),[C]=(0,i.useState)(F(E,I)),[U,R]=(0,i.useState)(Array.from(Array(d)).map((e,t)=>{let a=h.MathUtils.randInt(0,I.length-1);return new x({x:I[a].x,y:I[a].y,z:I[a].z,vx:h.MathUtils.randFloat(-2,2),vy:h.MathUtils.randFloat(-2,2),vz:h.MathUtils.randFloat(-2,2),bias:p(t,d)||g(t,d)?h.MathUtils.randFloat(4e-5,.01):0,id:t,action:r.FLYING,perchDur:h.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:[I[a].x,I[a].y,I[a].z]})})),[X,Y]=(0,i.useState)(d),[G,L]=(0,i.useState)([0,0,0]);(0,i.useEffect)(()=>{let e=e=>{let t=((e.clientX-230)/b.domElement.clientWidth-.5)*b.domElement.clientWidth,a=-((e.clientY-30)/b.domElement.clientHeight-.5)*b.domElement.clientHeight;L([t,a,0])};b.domElement.addEventListener("mousemove",e)},[]),(0,i.useEffect)(()=>{let e=d-U.length;if(e>0){let n=h.MathUtils.randInt(0,I.length-1);Array.from(Array(e)).forEach(()=>U.push(new x({x:h.MathUtils.randFloat(-1*t[0]/2,t[0]/2),y:h.MathUtils.randFloat(-1*t[1]/2+a,t[1]/2+a),z:h.MathUtils.randFloat(-1*t[2]/2,t[2]/2),vx:h.MathUtils.randFloat(-2,2),vy:h.MathUtils.randFloat(-2,2),vz:h.MathUtils.randFloat(-2,2),bias:0,id:U.length,action:r.FLYING,perchDur:h.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:[I[n].x,I[n].y,I[n].z]})))}else Array.from(Array(-1*e)).forEach(()=>U.pop());R(U),M.children.forEach((e,t)=>{if(e instanceof h.Mesh&&e.geometry instanceof h.ConeGeometry&&e instanceof h.Mesh&&e.geometry instanceof h.ConeGeometry&&parseInt(e.name)>X){var a;null===(a=e.geometry)||void 0===a||a.rotateX(Math.PI/2)}}),Y(M.children.length)},[d,M.children.length]);let Z=e=>{R(U.map(t=>t.id===e.id?e:t))};return(0,o.A)(e=>{S.update();let s=new Map,i=2*Math.max(n.protectedRange,n.visualRange),l=U.map((l,o)=>{var c;let d=JSON.stringify([(0,m.Z)(l.x/i)*i,(0,m.Z)(l.y/i)*i,(0,m.Z)(l.z/i)*i]);new Set(Array.from(s.keys())).has(d)?null===(c=s.get(d))||void 0===c||c.push(l):s.set(d,[l]);let x=v([(0,m.Z)(l.x/i)*i,(0,m.Z)(l.y/i)*i,(0,m.Z)(l.z/i)*i],i,l),u=e.clock.getElapsedTime(),p=new h.Vector3(l.x,l.y,l.z),g=new h.Vector3(l.perchLoc[0],l.perchLoc[1],l.perchLoc[2]),V=p.distanceTo(g);if(u>17&&V<150&&(u<l.perchedAt+l.perchDur||0===l.perchedAt)&&(l.willPerch()||l.action!==r.FLYING)){let z=f(V,l,u);return z}{let j=y(U,s,x,l,t,a,n,G,e.clock.getElapsedTime());return j}});R(l)}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("pointLight",{ref:w,position:[0,.2,4],intensity:.1,color:new h.Color(90,60,0)}),(0,s.jsxs)("mesh",{position:[0,a,0],children:[(0,s.jsx)("boxGeometry",{args:[t[0],t[1],t[2]],ref:N}),(0,s.jsx)("meshStandardMaterial",{color:"gray",opacity:l,transparent:!0,side:h.DoubleSide})]}),U.map((e,t)=>(0,s.jsxs)("mesh",{name:e.id.toString(),position:[e.x,e.y,e.z],onUpdate(t){t.lookAt(new h.Vector3(e.x+e.vx,e.y+e.vy,e.z+e.vz))},children:[(0,s.jsx)("coneGeometry",{args:[1,5],onUpdate(t){let a=new h.Vector3(e.x,e.y,e.z),n=new h.Vector3(e.perchLoc[0],e.perchLoc[1],e.perchLoc[2]),s=a.distanceTo(n);e.action===r.PERCHED&&s>5&&(t.rotateX(Math.PI/2),e.setVXYZ(h.MathUtils.randFloat(-2,2),h.MathUtils.randFloat(-2,2),h.MathUtils.randFloat(-2,2)),e.setAction(r.FLYING),Z(e)),e.action===r.PERCHING&&(t.rotateX(-Math.PI/2),e.setAction(r.PERCHED),Z(e))}}),(0,s.jsx)("meshStandardMaterial",{color:"blue"})]},t)),E.map((e,t)=>z(e)),E.map((e,t)=>{let a=A.get(t);return a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("mesh",{position:[a[0].x,a[0].y-8,a[0].z],rotation:new h.Euler(0,e.rotation+Math.PI/2,0),children:[(0,s.jsx)("boxGeometry",{args:[1===e.numParallel?10:2===e.numParallel?1.5*e.spacing:3*e.spacing,3,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),(0,s.jsxs)("mesh",{position:[a[1].x,a[1].y-8,a[1].z],rotation:new h.Euler(0,e.rotation+Math.PI/2,0),children:[(0,s.jsx)("boxGeometry",{args:[1===e.numParallel?10:2===e.numParallel?1.5*e.spacing:3*e.spacing,3,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),(0,s.jsxs)("mesh",{position:[a[0].x,a[0].y-150,a[0].z],children:[(0,s.jsx)("boxGeometry",{args:[3,300,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),(0,s.jsxs)("mesh",{position:[a[1].x,a[1].y-150,a[1].z],children:[(0,s.jsx)("boxGeometry",{args:[3,300,3]}),(0,s.jsx)("meshStandardMaterial",{color:"gray"})]}),Array.from(Array(e.numParallel)).map((e,a)=>{let n=C.get(JSON.stringify([t,a]));return n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("mesh",{position:[n[0].x,n[0].y-4,n[0].z],children:[(0,s.jsx)("cylinderGeometry",{args:[.5,1,5]}),(0,s.jsx)("meshStandardMaterial",{color:new h.Color(3355443)})]}),(0,s.jsxs)("mesh",{position:[n[1].x,n[1].y-4,n[1].z],children:[(0,s.jsx)("cylinderGeometry",{args:[.5,1,5]}),(0,s.jsx)("meshStandardMaterial",{color:new h.Color(3355443)})]})]}):(0,s.jsx)(s.Fragment,{})})]}):(0,s.jsx)(s.Fragment,{})})]})},p=(e,t)=>e<t/5,g=(e,t)=>e>t/5&&e<2*t/5,y=(e,t,a,n,r,s,i,l,o)=>{if(o<n.perchDur)return n;let c=new h.Vector3(n.x,n.y,n.z);new h.Vector3(n.vx,n.vy,n.vz);let m=0,d=0,x=0,u=0,y=0,f=0,v=0,V=0,z=0,j=0;for(let F of a)if(new Set(Array.from(t.keys())).has(F)){for(let b of t.get(F)||[])if(b.id!==n.id){let M=new h.Vector3(b.x,b.y,b.z);c.distanceTo(M)<i.visualRange&&(m+=b.x,d+=b.y,x+=b.z,u+=b.vx,y+=b.vy,f+=b.vz,j+=1),c.distanceTo(M)<i.protectedRange&&(v+=c.x-M.x,V+=c.y-M.y,z+=c.z-M.z)}}j>0&&n.incremVXYZ((m/j-n.x)*i.centeringFactor+(u/j-n.vx)*i.matchingFactor,(d/j-n.y)*i.centeringFactor+(y/j-n.vy)*i.matchingFactor,(x/j-n.z)*i.centeringFactor+(f/j-n.vz)*i.matchingFactor),n.incremVXYZ(v*i.avoidFactor,V*i.avoidFactor,z*i.avoidFactor);let S=r[0]/2,w=-1*r[0]/2,P=r[1]/2+s,N=-1*r[1]/2+s,E=r[2]/2,I=-1*r[2]/2;n.x>S&&n.incremVX(-1*i.turnFactor),n.x<w&&n.incremVX(i.turnFactor),n.y>P&&n.incremVY(-1*i.turnFactor),n.y<N&&n.incremVY(i.turnFactor),n.z>E&&n.incremVZ(-1*i.turnFactor),n.z<I&&n.incremVZ(i.turnFactor),p(n.id,e.length)&&(n.vx>0?n.setBias(Math.min(i.maxBias,n.bias+i.biasIncrm)):n.setBias(Math.max(i.biasIncrm,n.bias-i.biasIncrm))),g(n.id,e.length)&&(n.vx<0?n.setBias(Math.min(i.maxBias,n.bias+i.biasIncrm)):n.setBias(Math.max(i.biasIncrm,n.bias-i.biasIncrm))),p(n.id,e.length)&&n.setVX((1-n.bias)*n.vx+n.bias),g(n.id,e.length)&&n.setVX((1-n.bias)*n.vx-n.bias);let A=n.getSpeed();return A<i.minSpeed&&(n.setVX(n.vx/A*i.minSpeed),n.setVY(n.vy/A*i.minSpeed),n.setVZ(n.vz/A*i.minSpeed)),A>i.maxSpeed&&(n.setVX(n.vx/A*i.maxSpeed),n.setVY(n.vy/A*i.maxSpeed),n.setVZ(n.vz/A*i.maxSpeed)),n.perchedAt+n.perchDur+10<o&&n.setPerchedAt(0),n.move(),n},f=(e,t,a)=>{if(t.action===r.PERCHED&&a<t.perchedAt+t.perchDur)return t;let n=new h.Vector3(t.x,t.y,t.z),s=new h.Vector3(t.perchLoc[0],t.perchLoc[1],t.perchLoc[2]);if(e>2&&0===t.perchedAt){t.setAction(r.FLYINGDOWN),t.incremVX((s.x-n.x)*.01),t.incremVY((s.y-n.y)*.01),t.incremVZ((s.z-n.z)*.01);let i=t.getSpeed();i>2&&(t.setVX(t.vx/i*2),t.setVY(t.vy/i*2),t.setVZ(t.vz/i*2)),t.move()}else t.setXYZ(s.x,s.y,s.z),t.setVXYZ(0,0,0),t.setAction(r.PERCHING),t.setPerchedAt(a);return t},v=(e,t,a)=>{let n,r,s;let i=a.x,l=a.y,o=a.z,c=e[0]+t/2,h=e[1]+t/2,m=e[2]+t/2,d=[];return n=i<c?e[0]-t:e[0]+t,r=l<h?e[1]-t:e[1]+t,s=o<m?e[2]-t:e[2]+t,d.push(JSON.stringify([e[0],r,e[2]])),d.push(JSON.stringify([e[0],r,s])),d.push(JSON.stringify([e[0],e[1],e[2]])),d.push(JSON.stringify([e[0],e[1],s])),d.push(JSON.stringify([n,r,e[2]])),d.push(JSON.stringify([n,r,s])),d.push(JSON.stringify([n,e[1],e[2]])),d.push(JSON.stringify([n,e[1],s])),d},V=e=>{let t=[];for(let a of e)for(let n=0;n<a.numParallel;n++){let r=new h.EllipseCurve(a.ax,a.ay+2,a.xRadius,a.yRadius,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50).map(e=>new h.Vector3(e.x,e.y,0===n?a.zTranslate:1===n?a.spacing%2==0?a.zTranslate+a.spacing:a.zTranslate+a.spacing/2:a.zTranslate+2*a.spacing));for(let s of r)t.push(new h.Vector3(s.x,s.y,s.z).applyEuler(new h.Euler(0,a.rotation,0)))}return t},z=e=>Array.from(Array(e.numParallel)).map((t,a)=>(0,s.jsx)(d.x,{points:new h.EllipseCurve(e.ax,e.ay,e.xRadius,e.yRadius,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50).map(t=>new h.Vector3(t.x,t.y,0===a?e.zTranslate:1===a?e.spacing%2==0?e.zTranslate+e.spacing:e.zTranslate+e.spacing/2:e.zTranslate+2*e.spacing)),color:"blue",lineWidth:1,rotation:new h.Euler(0,e.rotation,0)},e.ax+e.ay+a)),j=(e,t)=>{let a=new Map,n=0,r=0;for(let s=0;s<e.length;s++){r=(n=0===s?0:r+1)+50*e[s].numParallel+(e[s].numParallel-1);let i=t[n],l=t[r];if(0===e[s].rotation){let o=(i.z+l.z)/2,c=new h.Vector3(i.x,i.y,o),m=new h.Vector3(l.x,l.y,o);a.set(s,[c,m])}else{let d=(i.x+l.x)/2,x=new h.Vector3(d,i.y,i.z),u=new h.Vector3(d,l.y,l.z);a.set(s,[x,u])}}return a},F=(e,t)=>{let a=new Map,n=0,r=0;for(let s=0;s<e.length;s++)for(let i=0;i<e[s].numParallel;i++)r=(n=0===s&&0===i?0:r+1)+50,a.set(JSON.stringify([s,i]),[t[n],t[r]]);return a};var b=a(7090);let M=()=>{let[e,t]=(0,i.useState)([300,180,240]),[a,n]=(0,i.useState)(100),[r,o]=(0,i.useState)(0),[c,h]=(0,i.useState)(400),[m,d]=(0,i.useState)({turnfactor:.2,visualRange:40,protectedRange:4,centeringFactor:5e-4,avoidFactor:.05,matchingFactor:.05,maxSpeed:4,minSpeed:2,turnFactor:.2,maxBias:.01,biasIncrm:4e-5});return(0,s.jsxs)("div",{className:"flex flex-row items-center bg-black space-x-4 h-full w-full absolute",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-4 ml-4 mt-4",children:[(0,s.jsx)(S,{name:"number birds",min:0,max:700,defaultVal:[c],step:1,onValueChange:e=>h(e[0])}),(0,s.jsx)(S,{name:"x boundry",min:30,max:300,defaultVal:[e[0]],step:1,onValueChange:a=>t([a[0],e[1],e[2]])}),(0,s.jsx)(S,{name:"y boundry",min:30,max:300,defaultVal:[e[1]],step:1,onValueChange:a=>t([e[0],a[0],e[2]])}),(0,s.jsx)(S,{name:"z boundry",min:30,max:300,defaultVal:[e[2]],step:1,onValueChange:a=>t([e[0],e[1],a[0]])}),(0,s.jsx)(S,{name:"height",min:-200,max:200,defaultVal:[a],step:1,onValueChange:e=>n(e[0])}),(0,s.jsx)(S,{name:"visual range",min:0,max:60,defaultVal:[m.visualRange],step:1,onValueChange:e=>d({...m,visualRange:e[0]})}),(0,s.jsx)(S,{name:"protected range",min:0,max:20,defaultVal:[m.protectedRange],step:1,onValueChange:e=>d({...m,protectedRange:e[0]})}),(0,s.jsx)(S,{name:"centering factor",min:0,max:.01,defaultVal:[m.centeringFactor],step:1e-4,onValueChange:e=>d({...m,centeringFactor:e[0]})}),(0,s.jsx)(S,{name:"avoid factor",min:0,max:.1,defaultVal:[m.avoidFactor],step:.001,onValueChange:e=>d({...m,avoidFactor:e[0]})}),(0,s.jsx)(S,{name:"matching factor",min:0,max:.1,defaultVal:[m.matchingFactor],step:.001,onValueChange:e=>d({...m,matchingFactor:e[0]})}),(0,s.jsx)(S,{name:"turning factor",min:.1,max:.5,defaultVal:[m.turnFactor],step:.001,onValueChange:e=>d({...m,turnFactor:e[0]})}),(0,s.jsx)(S,{name:"speed range",min:1,max:6,defaultVal:[m.minSpeed,m.maxSpeed],step:.1,onValueChange:e=>d({...m,minSpeed:e[0],maxSpeed:e[1]})}),(0,s.jsx)(S,{name:"bias range",min:0,max:.03,defaultVal:[m.biasIncrm,m.maxBias],step:1e-5,onValueChange:e=>d({...m,biasIncrm:e[0],maxBias:e[1]})}),(0,s.jsx)(S,{name:"box opacity",min:0,max:1,defaultVal:[r],step:.01,onValueChange:e=>o(e[0])})]}),(0,s.jsx)("div",{className:"w-4/5 h-[700px] bg-black",children:(0,s.jsx)(l.Xz,{shadows:!0,camera:{fov:75,position:[400,50,0]},className:"bg-blue-400",children:(0,s.jsx)(u,{border:e,height:a,boidConstants:m,boxOpacity:r,numberBirds:c})})})]})},S=e=>{let{min:t,max:a,defaultVal:n,step:r,name:i,onValueChange:l}=e;return(0,s.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,s.jsx)("span",{className:"text-white select-none",children:i}),(0,s.jsxs)(b.fC,{className:"relative select-none touch-none flex items-center w-[200px] h-2",minStepsBetweenThumbs:1,defaultValue:n,min:t,max:a,onValueCommit:l,step:r,"aria-label":"Volume",children:[(0,s.jsx)(b.fQ,{className:"relative bg-white rounded-full h-2 flex-grow",children:(0,s.jsx)(b.e6,{className:"absolute bg-green-500 rounded-full h-full"})}),n.map(e=>(0,s.jsx)(b.bU,{className:"block w-5 h-5 bg-green-500 rounded-full outline-none "},e))]})]})};var w=a(9008),P=a.n(w);function N(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(P(),{children:[(0,s.jsx)("title",{children:"Create Next App"}),(0,s.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,s.jsx)("link",{rel:"icon",href:"/Wings/favicon.ico"})]}),(0,s.jsx)(M,{})]})}}},function(e){e.O(0,[737,962,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);