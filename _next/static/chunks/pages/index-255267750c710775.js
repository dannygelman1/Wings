(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(2094)}])},2094:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return j}});var n=t(5893),r=t(7294),s=t(5029),o=t(1884),i=t(9365),l=t(9477),c=t(2051);let m=e=>{let{border:a,boidConstants:t,boxOpacity:s,numberBirds:m}=e,{camera:x,gl:g,scene:p}=(0,o.z)(),y=new i.z(x,g.domElement);y.enableDamping=!0,y.rotateSpeed=.01,y.zoomSpeed=.001;let F=(0,r.useRef)(null),j=(0,r.useRef)(null);p.add(x),F.current&&x.add(F.current),j.current&&x.add(j.current);let S=(0,r.useRef)(null);(0,r.useEffect)(()=>{p.children.forEach(e=>{var a;e instanceof l.Mesh&&e.geometry instanceof l.ConeGeometry&&(null===(a=e.geometry)||void 0===a||a.rotateX(Math.PI/2))})},[]);let[b,V]=(0,r.useState)(Array.from(Array(m)).map((e,t)=>[l.MathUtils.randFloat(-1*a[0]/2,a[0]/2),l.MathUtils.randFloat(-1*a[1]/2,a[1]/2),l.MathUtils.randFloat(-1*a[2]/2,a[2]/2),l.MathUtils.randFloat(-2,2),l.MathUtils.randFloat(-2,2),l.MathUtils.randFloat(-2,2),u(t,m)||d(t,m)?l.MathUtils.randFloat(4e-5,.01):0,t])),[v,M]=(0,r.useState)(m);return(0,r.useEffect)(()=>{let e=m-b.length;e>0?Array.from(Array(e)).forEach(()=>b.push([l.MathUtils.randFloat(-1*a[0]/2,a[0]/2),l.MathUtils.randFloat(-1*a[1]/2,a[1]/2),l.MathUtils.randFloat(-1*a[2]/2,a[2]/2),l.MathUtils.randFloat(-2,2),l.MathUtils.randFloat(-2,2),l.MathUtils.randFloat(-2,2),0,b.length])):Array.from(Array(-1*e)).forEach(()=>b.pop()),V(b),p.children.forEach((e,a)=>{if(e instanceof l.Mesh&&e.geometry instanceof l.ConeGeometry&&e instanceof l.Mesh&&e.geometry instanceof l.ConeGeometry&&parseInt(e.name)>v){var t;null===(t=e.geometry)||void 0===t||t.rotateX(Math.PI/2)}}),M(p.children.length)},[m,p.children.length]),(0,o.A)(()=>{y.update();let e=new Map,n=2*Math.max(t.protectedRange,t.visualRange),r=b.map((r,s)=>{var o;let i=JSON.stringify([(0,c.Z)(r[0]/n)*n,(0,c.Z)(r[1]/n)*n,(0,c.Z)(r[2]/n)*n]);new Set(Array.from(e.keys())).has(i)?null===(o=e.get(i))||void 0===o||o.push(r):e.set(i,[r]);let l=f([(0,c.Z)(r[0]/n)*n,(0,c.Z)(r[1]/n)*n,(0,c.Z)(r[2]/n)*n],n,r),m=h(b,e,l,r,a,t);return m});V(r)}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("pointLight",{ref:F,position:[0,.2,4],intensity:.1,color:new l.Color(90,60,0)}),(0,n.jsx)("directionalLight",{ref:j,position:[0,4,0],intensity:.5,castShadow:!0}),(0,n.jsxs)("mesh",{position:[0,0,0],children:[(0,n.jsx)("boxGeometry",{args:[a[0],a[1],a[2]],ref:S}),(0,n.jsx)("meshStandardMaterial",{color:"gray",opacity:s,transparent:!0,wireframeLinejoin:"round",side:l.DoubleSide})]}),b.map((e,a)=>(0,n.jsxs)("mesh",{name:e[7].toString(),position:[e[0],e[1],e[2]],onUpdate(a){a.lookAt(new l.Vector3(e[0]+e[3],e[1]+e[4],e[2]+e[5]))},children:[(0,n.jsx)("coneGeometry",{args:[1,5]}),(0,n.jsx)("meshStandardMaterial",{color:"green"})]},a))]})},u=(e,a)=>e<a/5,d=(e,a)=>e>a/5&&e<2*a/5,h=(e,a,t,n,r,s)=>{let o=new l.Vector3(n[0],n[1],n[2]),i=0,c=0,m=0,h=0,f=0,x=0,g=0,p=0,y=0,F=0;for(let j of t)if(new Set(Array.from(a.keys())).has(j)){for(let S of a.get(j)||[])if(S[7]!==n[7]){let b=new l.Vector3(S[0],S[1],S[2]);o.distanceTo(b)<s.visualRange&&(i+=S[0],c+=S[1],m+=S[2],h+=S[3],f+=S[4],x+=S[5],F+=1),o.distanceTo(b)<s.protectedRange&&(g+=o.x-b.x,p+=o.y-b.y,y+=o.z-b.z)}}F>0&&(n[3]+=(i/F-n[0])*s.centeringFactor+(h/F-n[3])*s.matchingFactor,n[4]+=(c/F-n[1])*s.centeringFactor+(f/F-n[4])*s.matchingFactor,n[5]+=(m/F-n[2])*s.centeringFactor+(x/F-n[5])*s.matchingFactor),n[3]+=g*s.avoidFactor,n[4]+=p*s.avoidFactor,n[5]+=y*s.avoidFactor;let V=r[0]/2,v=-1*r[0]/2,M=r[1]/2,w=-1*r[1]/2,C=r[2]/2,N=-1*r[2]/2;n[0]>V&&(n[3]-=s.turnFactor),n[0]<v&&(n[3]+=s.turnFactor),n[1]>M&&(n[4]-=s.turnFactor),n[1]<w&&(n[4]+=s.turnFactor),n[2]>C&&(n[5]-=s.turnFactor),n[2]<N&&(n[5]+=s.turnFactor),u(n[7],e.length)&&(n[3]>0?n[6]=Math.min(s.maxBias,n[6]+s.biasIncrm):n[6]=Math.max(s.biasIncrm,n[6]-s.biasIncrm)),d(n[7],e.length)&&(n[3]<0?n[6]=Math.min(s.maxBias,n[6]+s.biasIncrm):n[6]=Math.max(s.biasIncrm,n[6]-s.biasIncrm)),u(n[7],e.length)&&(n[3]=(1-n[6])*n[3]+n[6]),d(n[7],e.length)&&(n[3]=(1-n[6])*n[3]-n[6]);let U=(n[3]**2+n[4]**2+n[5]**2)**.5;return U<s.minSpeed&&(n[3]=n[3]/U*s.minSpeed,n[4]=n[4]/U*s.minSpeed,n[5]=n[5]/U*s.minSpeed),U>s.maxSpeed&&(n[3]=n[3]/U*s.maxSpeed,n[4]=n[4]/U*s.maxSpeed,n[5]=n[5]/U*s.maxSpeed),n[0]+=n[3],n[1]+=n[4],n[2]+=n[5],n},f=(e,a,t)=>{let n,r,s;let o=t[0],i=t[1],l=t[2],c=e[0]+a/2,m=e[1]+a/2,u=e[2]+a/2,d=[];return n=o<c?e[0]-a:e[0]+a,r=i<m?e[1]-a:e[1]+a,s=l<u?e[2]-a:e[2]+a,d.push(JSON.stringify([e[0],r,e[2]])),d.push(JSON.stringify([e[0],r,s])),d.push(JSON.stringify([e[0],e[1],e[2]])),d.push(JSON.stringify([e[0],e[1],s])),d.push(JSON.stringify([n,r,e[2]])),d.push(JSON.stringify([n,r,s])),d.push(JSON.stringify([n,e[1],e[2]])),d.push(JSON.stringify([n,e[1],s])),d};var x=t(7090);let g=()=>{let[e,a]=(0,r.useState)([300,180,240]),[t,o]=(0,r.useState)(.4),[i,l]=(0,r.useState)(300),[c,u]=(0,r.useState)({turnfactor:.2,visualRange:40,protectedRange:4,centeringFactor:5e-4,avoidFactor:.05,matchingFactor:.05,maxSpeed:4,minSpeed:2,turnFactor:.2,maxBias:.01,biasIncrm:4e-5});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-full h-full h-grow bg-black absolute",children:(0,n.jsx)(s.Xz,{shadows:!0,camera:{fov:50,position:[Math.max(e[0],e[1],e[2]),Math.max(e[0],e[1],e[2]),Math.max(e[0],e[1],e[2])]},children:(0,n.jsx)(m,{border:e,boidConstants:c,boxOpacity:t,numberBirds:i})})}),(0,n.jsxs)("div",{className:"absolute flex flex-col space-y-4 ml-4 mt-4",children:[(0,n.jsx)(p,{name:"number birds",min:0,max:700,defaultVal:[i],step:1,onValueChange:e=>l(e[0])}),(0,n.jsx)(p,{name:"x boundry",min:30,max:300,defaultVal:[e[0]],step:1,onValueChange:t=>a([t[0],e[1],e[2]])}),(0,n.jsx)(p,{name:"y boundry",min:30,max:300,defaultVal:[e[1]],step:1,onValueChange:t=>a([e[0],t[0],e[2]])}),(0,n.jsx)(p,{name:"z boundry",min:30,max:300,defaultVal:[e[2]],step:1,onValueChange:t=>a([e[0],e[1],t[0]])}),(0,n.jsx)(p,{name:"visual range",min:0,max:60,defaultVal:[c.visualRange],step:1,onValueChange:e=>u({...c,visualRange:e[0]})}),(0,n.jsx)(p,{name:"protected range",min:0,max:20,defaultVal:[c.protectedRange],step:1,onValueChange:e=>u({...c,protectedRange:e[0]})}),(0,n.jsx)(p,{name:"centering factor",min:0,max:.01,defaultVal:[c.centeringFactor],step:1e-4,onValueChange:e=>u({...c,centeringFactor:e[0]})}),(0,n.jsx)(p,{name:"avoid factor",min:0,max:.1,defaultVal:[c.avoidFactor],step:.001,onValueChange:e=>u({...c,avoidFactor:e[0]})}),(0,n.jsx)(p,{name:"matching factor",min:0,max:.1,defaultVal:[c.matchingFactor],step:.001,onValueChange:e=>u({...c,matchingFactor:e[0]})}),(0,n.jsx)(p,{name:"turning factor",min:.1,max:.5,defaultVal:[c.turnFactor],step:.001,onValueChange:e=>u({...c,turnFactor:e[0]})}),(0,n.jsx)(p,{name:"speed range",min:1,max:6,defaultVal:[c.minSpeed,c.maxSpeed],step:.1,onValueChange:e=>u({...c,minSpeed:e[0],maxSpeed:e[1]})}),(0,n.jsx)(p,{name:"bias range",min:0,max:.03,defaultVal:[c.biasIncrm,c.maxBias],step:1e-5,onValueChange:e=>u({...c,biasIncrm:e[0],maxBias:e[1]})}),(0,n.jsx)(p,{name:"box opacity",min:0,max:1,defaultVal:[t],step:.01,onValueChange:e=>o(e[0])})]})]})},p=e=>{let{min:a,max:t,defaultVal:r,step:s,name:o,onValueChange:i}=e;return(0,n.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,n.jsx)("span",{className:"text-white select-none",children:o}),(0,n.jsxs)(x.fC,{className:"relative select-none touch-none flex items-center w-[200px] h-2",minStepsBetweenThumbs:1,defaultValue:r,min:a,max:t,onValueCommit:i,step:s,"aria-label":"Volume",children:[(0,n.jsx)(x.fQ,{className:"relative bg-white rounded-full h-2 flex-grow",children:(0,n.jsx)(x.e6,{className:"absolute bg-green-500 rounded-full h-full"})}),r.map(e=>(0,n.jsx)(x.bU,{className:"block w-5 h-5 bg-green-500 rounded-full outline-none "},e))]})]})};var y=t(9008),F=t.n(y);function j(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(F(),{children:[(0,n.jsx)("title",{children:"Create Next App"}),(0,n.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,n.jsx)("link",{rel:"icon",href:"/Wings/favicon.ico"})]}),(0,n.jsx)(g,{})]})}}},function(e){e.O(0,[737,515,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);