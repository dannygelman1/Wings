(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(13)}])},13:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var n,r,i=a(5893),s=a(7294),o=a(5029),l=a(1884),c=a(9365),h=a(9477),d=a(2051);(n=r||(r={}))[n.FLYING=0]="FLYING",n[n.FLYINGDOWN=1]="FLYINGDOWN",n[n.PERCHING=2]="PERCHING",n[n.PERCHED=3]="PERCHED";var m=a(8243);class u{incremXYZ(e,t,a){this.x+=e,this.y+=t,this.z+=a}incremVXYZ(e,t,a){this.vx+=e,this.vy+=t,this.vz+=a}incremVX(e){this.vx+=e}incremVY(e){this.vy+=e}incremVZ(e){this.vz+=e}setVX(e){this.vx=e}setVY(e){this.vy=e}setVZ(e){this.vz=e}setXYZ(e,t,a){this.x=e,this.y=t,this.z=a}setVXYZ(e,t,a){this.vx=e,this.vy=t,this.vz=a}willPerch(){return 8===h.MathUtils.randInt(0,200)}move(){this.x+=this.vx,this.y+=this.vy,this.z+=this.vz}setBias(e){this.bias=e}setAction(e){this.action=e}setPerchedAt(e){this.perchedAt=e}getSpeed(){return(this.vx**2+this.vy**2+this.vz**2)**.5}constructor({x:e,y:t,z:a,vx:n,vy:r,vz:i,bias:s,id:o,action:l,perchDur:c,perchedAt:h,perchLoc:d}){this.x=e,this.y=t,this.z=a,this.vx=n,this.vy=r,this.vz=i,this.bias=s,this.id=o,this.action=l,this.perchDur=c,this.perchedAt=h,this.perchLoc=d}}let x=e=>{let{border:t,height:a,boidConstants:n,boxOpacity:o,numberBirds:x}=e,{camera:F,gl:b,scene:z}=(0,l.z)(),M=new c.z(F,b.domElement);M.enableDamping=!0,M.rotateSpeed=.01,M.zoomSpeed=.001,M.target.set(0,0,0),F.position.set(F.position.x,0,F.position.z),F.lookAt(M.target),M.minPolarAngle=0,M.maxPolarAngle=180,M.target.set(0,0,0);let S=(0,s.useRef)(null),E=(0,s.useRef)(null);z.add(F),S.current&&F.add(S.current),E.current&&F.add(E.current);let N=(0,s.useRef)(null);(0,s.useEffect)(()=>{z.children.forEach(e=>{var t;e instanceof h.Mesh&&e.geometry instanceof h.ConeGeometry&&(null===(t=e.geometry)||void 0===t||t.rotateX(Math.PI/2))})},[]);let[j]=(0,s.useState)(Array.from(Array(8)).map(()=>({ax:h.MathUtils.randFloat(-100,100),ay:h.MathUtils.randFloat(-100,-50),xRadius:h.MathUtils.randFloat(50,150),yRadius:h.MathUtils.randFloat(10,80),rotation:h.MathUtils.randFloat(Math.PI/10,Math.PI)}))),[w]=(0,s.useState)(V(j)),[I,C]=(0,s.useState)(Array.from(Array(x)).map((e,t)=>{let a=h.MathUtils.randInt(0,w.length-1);return new u({x:w[a].x,y:w[a].y,z:w[a].z,vx:h.MathUtils.randFloat(-2,2),vy:h.MathUtils.randFloat(-2,2),vz:h.MathUtils.randFloat(-2,2),bias:p(t,x)||g(t,x)?h.MathUtils.randFloat(4e-5,.01):0,id:t,action:r.FLYING,perchDur:h.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:[w[a].x,w[a].y,w[a].z]})})),[A,P]=(0,s.useState)(x),[R,U]=(0,s.useState)([0,0,0]),[X,Y]=(0,s.useState)(h.MathUtils.randInt(15,40)),[L,Z]=(0,s.useState)(0);(0,s.useEffect)(()=>{let e=e=>{let t=((e.clientX-230)/b.domElement.clientWidth-.5)*b.domElement.clientWidth,a=-((e.clientY-30)/b.domElement.clientHeight-.5)*b.domElement.clientHeight;U([t,a,0])};b.domElement.addEventListener("mousemove",e)},[]),(0,s.useEffect)(()=>{let e=x-I.length;if(e>0){let n=h.MathUtils.randInt(0,w.length-1);Array.from(Array(e)).forEach(()=>I.push(new u({x:h.MathUtils.randFloat(-1*t[0]/2,t[0]/2),y:h.MathUtils.randFloat(-1*t[1]/2+a,t[1]/2+a),z:h.MathUtils.randFloat(-1*t[2]/2,t[2]/2),vx:h.MathUtils.randFloat(-2,2),vy:h.MathUtils.randFloat(-2,2),vz:h.MathUtils.randFloat(-2,2),bias:0,id:I.length,action:r.FLYING,perchDur:h.MathUtils.randFloat(10/3,10),perchedAt:0,perchLoc:[w[n].x,w[n].y,w[n].z]})))}else Array.from(Array(-1*e)).forEach(()=>I.pop());C(I),z.children.forEach((e,t)=>{if(e instanceof h.Mesh&&e.geometry instanceof h.ConeGeometry&&e instanceof h.Mesh&&e.geometry instanceof h.ConeGeometry&&parseInt(e.name)>A){var a;null===(a=e.geometry)||void 0===a||a.rotateX(Math.PI/2)}}),P(z.children.length)},[x,z.children.length]);let G=e=>{C(I.map(t=>t.id===e.id?e:t))};return(0,l.A)(e=>{M.update();let i=new Map,s=2*Math.max(n.protectedRange,n.visualRange),o=I.map((o,l)=>{var c;let m=JSON.stringify([(0,d.Z)(o.x/s)*s,(0,d.Z)(o.y/s)*s,(0,d.Z)(o.z/s)*s]);new Set(Array.from(i.keys())).has(m)?null===(c=i.get(m))||void 0===c||c.push(o):i.set(m,[o]);let u=v([(0,d.Z)(o.x/s)*s,(0,d.Z)(o.y/s)*s,(0,d.Z)(o.z/s)*s],s,o),x=e.clock.getElapsedTime(),p=new h.Vector3(o.x,o.y,o.z),g=new h.Vector3(o.perchLoc[0],o.perchLoc[1],o.perchLoc[2]),V=p.distanceTo(g);if(x>10&&V<150&&(x<o.perchedAt+o.perchDur||0===o.perchedAt)&&(o.willPerch()||o.action!==r.FLYING)){let F=y(V,o,n,j,x);return F}{let b=f(I,i,u,o,t,a,n,R,e.clock.getElapsedTime());return b}});C(o)}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("pointLight",{ref:S,position:[0,.2,4],intensity:.1,color:new h.Color(90,60,0)}),(0,i.jsxs)("mesh",{position:[0,a,0],children:[(0,i.jsx)("boxGeometry",{args:[t[0],t[1],t[2]],ref:N}),(0,i.jsx)("meshStandardMaterial",{color:"gray",opacity:o,transparent:!0,side:h.DoubleSide})]}),I.map((e,t)=>(0,i.jsxs)("mesh",{name:e.id.toString(),position:[e.x,e.y,e.z],onUpdate(t){t.lookAt(new h.Vector3(e.x+e.vx,e.y+e.vy,e.z+e.vz))},children:[(0,i.jsx)("coneGeometry",{args:[1,5],onUpdate(t){let a=new h.Vector3(e.x,e.y,e.z),n=new h.Vector3(e.perchLoc[0],e.perchLoc[1],e.perchLoc[2]),i=a.distanceTo(n);e.action===r.PERCHED&&i>5&&(t.rotateX(Math.PI/2),e.setVXYZ(h.MathUtils.randFloat(-2,2),h.MathUtils.randFloat(-2,2),h.MathUtils.randFloat(-2,2)),e.setAction(r.FLYING),G(e)),e.action===r.PERCHING&&(t.rotateX(-Math.PI/2),e.setAction(r.PERCHED),G(e))}}),(0,i.jsx)("meshStandardMaterial",{color:0===e.perchedAt?"blue":"red"})]},t)),j.map((e,t)=>(0,i.jsx)(m.x,{points:new h.EllipseCurve(e.ax,e.ay,e.xRadius,e.yRadius,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50),color:"blue",lineWidth:1,rotation:new h.Euler(0,e.rotation,0)},t))]})},p=(e,t)=>e<t/5,g=(e,t)=>e>t/5&&e<2*t/5,f=(e,t,a,n,i,s,o,l,c)=>{if(n.action===r.PERCHED&&c<n.perchedAt+n.perchDur&&c>10)return n;let d=new h.Vector3(n.x,n.y,n.z);new h.Vector3(n.vx,n.vy,n.vz);let m=0,u=0,x=0,f=0,y=0,v=0,V=0,F=0,b=0,z=0;for(let M of a)if(new Set(Array.from(t.keys())).has(M)){for(let S of t.get(M)||[])if(S.id!==n.id){let E=new h.Vector3(S.x,S.y,S.z);d.distanceTo(E)<o.visualRange&&(m+=S.x,u+=S.y,x+=S.z,f+=S.vx,y+=S.vy,v+=S.vz,z+=1),d.distanceTo(E)<o.protectedRange&&(V+=d.x-E.x,F+=d.y-E.y,b+=d.z-E.z)}}z>0&&n.incremVXYZ((m/z-n.x)*o.centeringFactor+(f/z-n.vx)*o.matchingFactor,(u/z-n.y)*o.centeringFactor+(y/z-n.vy)*o.matchingFactor,(x/z-n.z)*o.centeringFactor+(v/z-n.vz)*o.matchingFactor),n.incremVXYZ(V*o.avoidFactor,F*o.avoidFactor,b*o.avoidFactor);let N=i[0]/2,j=-1*i[0]/2,w=i[1]/2+s,I=-1*i[1]/2+s,C=i[2]/2,A=-1*i[2]/2;n.x>N&&n.incremVX(-1*o.turnFactor),n.x<j&&n.incremVX(o.turnFactor),n.y>w&&n.incremVY(-1*o.turnFactor),n.y<I&&n.incremVY(o.turnFactor),n.z>C&&n.incremVZ(-1*o.turnFactor),n.z<A&&n.incremVZ(o.turnFactor),p(n.id,e.length)&&(n.vx>0?n.setBias(Math.min(o.maxBias,n.bias+o.biasIncrm)):n.setBias(Math.max(o.biasIncrm,n.bias-o.biasIncrm))),g(n.id,e.length)&&(n.vx<0?n.setBias(Math.min(o.maxBias,n.bias+o.biasIncrm)):n.setBias(Math.max(o.biasIncrm,n.bias-o.biasIncrm))),p(n.id,e.length)&&n.setVX((1-n.bias)*n.vx+n.bias),g(n.id,e.length)&&n.setVX((1-n.bias)*n.vx-n.bias);let P=n.getSpeed();return P<o.minSpeed&&(n.setVX(n.vx/P*o.minSpeed),n.setVY(n.vy/P*o.minSpeed),n.setVZ(n.vz/P*o.minSpeed)),P>o.maxSpeed&&(n.setVX(n.vx/P*o.maxSpeed),n.setVY(n.vy/P*o.maxSpeed),n.setVZ(n.vz/P*o.maxSpeed)),n.perchedAt+n.perchDur+10<c&&n.setPerchedAt(0),n.move(),n},y=(e,t,a,n,i)=>{if(t.action===r.PERCHED&&i<t.perchedAt+t.perchDur)return t;let s=new h.Vector3(t.x,t.y,t.z),o=new h.Vector3(t.perchLoc[0],t.perchLoc[1],t.perchLoc[2]);if(e>2&&0===t.perchedAt){t.setAction(r.FLYINGDOWN),t.incremVX((o.x-s.x)*.01),t.incremVY((o.y-s.y)*.01),t.incremVZ((o.z-s.z)*.01);let l=t.getSpeed();l>2&&(t.setVX(t.vx/l*2),t.setVY(t.vy/l*2),t.setVZ(t.vz/l*2)),t.move()}else t.setXYZ(o.x,o.y,o.z),t.setVXYZ(0,0,0),t.setAction(r.PERCHING),t.setPerchedAt(i);return t},v=(e,t,a)=>{let n,r,i;let s=a.x,o=a.y,l=a.z,c=e[0]+t/2,h=e[1]+t/2,d=e[2]+t/2,m=[];return n=s<c?e[0]-t:e[0]+t,r=o<h?e[1]-t:e[1]+t,i=l<d?e[2]-t:e[2]+t,m.push(JSON.stringify([e[0],r,e[2]])),m.push(JSON.stringify([e[0],r,i])),m.push(JSON.stringify([e[0],e[1],e[2]])),m.push(JSON.stringify([e[0],e[1],i])),m.push(JSON.stringify([n,r,e[2]])),m.push(JSON.stringify([n,r,i])),m.push(JSON.stringify([n,e[1],e[2]])),m.push(JSON.stringify([n,e[1],i])),m},V=e=>{let t=[];for(let a of e){let n=new h.EllipseCurve(a.ax,a.ay+2,a.xRadius,a.yRadius,Math.PI+Math.PI/8,0-Math.PI/8,!1,0).getPoints(50);for(let r of n)t.push(new h.Vector3(r.x,r.y,0).applyEuler(new h.Euler(0,a.rotation,0)))}return t};var F=a(7090);let b=()=>{let[e,t]=(0,s.useState)([300,180,240]),[a,n]=(0,s.useState)(100),[r,l]=(0,s.useState)(0),[c,h]=(0,s.useState)(300),[d,m]=(0,s.useState)({turnfactor:.2,visualRange:40,protectedRange:4,centeringFactor:5e-4,avoidFactor:.05,matchingFactor:.05,maxSpeed:4,minSpeed:2,turnFactor:.2,maxBias:.01,biasIncrm:4e-5});return(0,i.jsxs)("div",{className:"flex flex-row items-center bg-black space-x-4 h-full w-full absolute",children:[(0,i.jsxs)("div",{className:"flex flex-col space-y-4 ml-4 mt-4",children:[(0,i.jsx)(z,{name:"number birds",min:0,max:700,defaultVal:[c],step:1,onValueChange:e=>h(e[0])}),(0,i.jsx)(z,{name:"x boundry",min:30,max:300,defaultVal:[e[0]],step:1,onValueChange:a=>t([a[0],e[1],e[2]])}),(0,i.jsx)(z,{name:"y boundry",min:30,max:300,defaultVal:[e[1]],step:1,onValueChange:a=>t([e[0],a[0],e[2]])}),(0,i.jsx)(z,{name:"z boundry",min:30,max:300,defaultVal:[e[2]],step:1,onValueChange:a=>t([e[0],e[1],a[0]])}),(0,i.jsx)(z,{name:"height",min:-200,max:200,defaultVal:[a],step:1,onValueChange:e=>n(e[0])}),(0,i.jsx)(z,{name:"visual range",min:0,max:60,defaultVal:[d.visualRange],step:1,onValueChange:e=>m({...d,visualRange:e[0]})}),(0,i.jsx)(z,{name:"protected range",min:0,max:20,defaultVal:[d.protectedRange],step:1,onValueChange:e=>m({...d,protectedRange:e[0]})}),(0,i.jsx)(z,{name:"centering factor",min:0,max:.01,defaultVal:[d.centeringFactor],step:1e-4,onValueChange:e=>m({...d,centeringFactor:e[0]})}),(0,i.jsx)(z,{name:"avoid factor",min:0,max:.1,defaultVal:[d.avoidFactor],step:.001,onValueChange:e=>m({...d,avoidFactor:e[0]})}),(0,i.jsx)(z,{name:"matching factor",min:0,max:.1,defaultVal:[d.matchingFactor],step:.001,onValueChange:e=>m({...d,matchingFactor:e[0]})}),(0,i.jsx)(z,{name:"turning factor",min:.1,max:.5,defaultVal:[d.turnFactor],step:.001,onValueChange:e=>m({...d,turnFactor:e[0]})}),(0,i.jsx)(z,{name:"speed range",min:1,max:6,defaultVal:[d.minSpeed,d.maxSpeed],step:.1,onValueChange:e=>m({...d,minSpeed:e[0],maxSpeed:e[1]})}),(0,i.jsx)(z,{name:"bias range",min:0,max:.03,defaultVal:[d.biasIncrm,d.maxBias],step:1e-5,onValueChange:e=>m({...d,biasIncrm:e[0],maxBias:e[1]})}),(0,i.jsx)(z,{name:"box opacity",min:0,max:1,defaultVal:[r],step:.01,onValueChange:e=>l(e[0])})]}),(0,i.jsx)("div",{className:"w-4/5 h-[700px] bg-black",children:(0,i.jsx)(o.Xz,{shadows:!0,camera:{fov:75,position:[0,50,400]},className:"bg-blue-400",children:(0,i.jsx)(x,{border:e,height:a,boidConstants:d,boxOpacity:r,numberBirds:c})})})]})},z=e=>{let{min:t,max:a,defaultVal:n,step:r,name:s,onValueChange:o}=e;return(0,i.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,i.jsx)("span",{className:"text-white select-none",children:s}),(0,i.jsxs)(F.fC,{className:"relative select-none touch-none flex items-center w-[200px] h-2",minStepsBetweenThumbs:1,defaultValue:n,min:t,max:a,onValueCommit:o,step:r,"aria-label":"Volume",children:[(0,i.jsx)(F.fQ,{className:"relative bg-white rounded-full h-2 flex-grow",children:(0,i.jsx)(F.e6,{className:"absolute bg-green-500 rounded-full h-full"})}),n.map(e=>(0,i.jsx)(F.bU,{className:"block w-5 h-5 bg-green-500 rounded-full outline-none "},e))]})]})};var M=a(9008),S=a.n(M);function E(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(S(),{children:[(0,i.jsx)("title",{children:"Create Next App"}),(0,i.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,i.jsx)("link",{rel:"icon",href:"/Wings/favicon.ico"})]}),(0,i.jsx)(b,{})]})}}},function(e){e.O(0,[737,962,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);